starting experiment
Using device: cuda:0
Loading model from trained_models/webqsp_Apr15_bnn3_working/cpt.pth
DEBUG: Model checkpoint loaded successfully
Loading test dataset
# skipped samples: 0
# relevant triples | median: 4 | mean: 20 | max: 699
DEBUG: Loaded test dataset with 1639 samples

==================== SAMPLED Q/A PAIRS ====================

Sample #0:
Question: what was dr seuss real name
Answer entity: ['Theodor Seuss Geisel']
Question entity: ['Theodore Lesieg']

Sample #1:
Question: which countries share a border with russia
Answer entity: ['Lithuania', 'China', 'Azerbaijan', 'Georgia', 'Norway', 'Kazakhstan', 'Finland', 'Ukraine', 'Estonia', 'Mongolia', 'Poland', 'Latvia', 'North Korea', 'Belarus']
Question entity: ['Russia']

Sample #2:
Question: what kind of cancer did carl wilson have
Answer entity: ['Lung cancer', 'Brain tumor']
Question entity: ['Carl Wilson']

Sample #3:
Question: who was william mckinley married to
Answer entity: ['Ida Saxton McKinley']
Question entity: ['William McKinley']

Sample #4:
Question: what countries have territories in oceania
Answer entity: ['Fiji', 'American Samoa', 'Australia', 'Kiribati', 'Northern Mariana Islands', 'Niue', 'Tonga', 'French Polynesia', 'Solomon Islands', 'Nauru', 'Tokelau', 'Guam', 'Vanuatu', 'Tuvalu', 'New Caledonia', 'Indonesia', 'Norfolk Island', 'Marshall Islands', 'Timor-Leste', 'Papua New Guinea', 'Palau', 'Samoa', 'Federated States of Micronesia', 'Pitcairn Islands', 'New Zealand', 'Wallis and Futuna', 'Cook Islands']
Question entity: ['Oceania']
DEBUG: Sampled 5 QA pairs
DEBUG: Model initialized and loaded state dict
Using cache directory: /home/gridsan/brich/subgraphrag/BenSubgraphRag/SubGraphRag/retrieve/model_cache
Attempting to load model from local cache: /home/gridsan/brich/subgraphrag/BenSubgraphRag/SubGraphRag/retrieve/model_cache

==================== CUSTOM QUERY ANALYSIS ====================
Custom Query: Who was Dr. Seuss's Mistress's Dog?
Target Entity: Theodor Seuss Geisel
Using question entity: Theodore Lesieg
Found 4 test samples with question entity Theodore Lesieg

==================== RUNNING INFERENCE ON CUSTOM QUERY ====================
DEBUG: Starting inference on sample
DEBUG: Sample collated
DEBUG: Sample prepared, number of triples: 5494
DEBUG: Entity list length: 1695, Relation list length: 363
DEBUG: Starting Monte Carlo sampling
DEBUG: Completed MC sample 1/5
DEBUG: Completed MC sample 2/5
DEBUG: Completed MC sample 3/5
DEBUG: Completed MC sample 4/5
DEBUG: Completed MC sample 5/5
DEBUG: Monte Carlo sampling completed
DEBUG: Stacked predictions shape: torch.Size([5, 5494])
DEBUG: Mean and std calculated
DEBUG: Converted to probabilities
DEBUG: Top 10 triples selected
DEBUG: Formatted 10 triples for return

==================== COMPARISON SAMPLE #1 ====================
Question: what was dr seuss education
Answer entity: ['Lincoln College, Oxford', 'University of Oxford', 'Dartmouth College']
DEBUG: Starting inference on sample
DEBUG: Sample collated
DEBUG: Sample prepared, number of triples: 5494
DEBUG: Entity list length: 1695, Relation list length: 363
DEBUG: Starting Monte Carlo sampling
DEBUG: Completed MC sample 1/5
DEBUG: Completed MC sample 2/5
DEBUG: Completed MC sample 3/5
DEBUG: Completed MC sample 4/5
DEBUG: Completed MC sample 5/5
DEBUG: Monte Carlo sampling completed
DEBUG: Stacked predictions shape: torch.Size([5, 5494])
DEBUG: Mean and std calculated
DEBUG: Converted to probabilities
DEBUG: Top 10 triples selected
DEBUG: Formatted 10 triples for return

==================== COMPARISON SAMPLE #2 ====================
Question: what did dr. seuss do
Answer entity: ['Visual Artist', 'Poet', 'Writer', 'Animator', 'Television producer', 'Screenwriter', 'Artist', 'Film Producer', 'Illustrator', 'Songwriter', 'Cartoonist']
DEBUG: Starting inference on sample
DEBUG: Sample collated
DEBUG: Sample prepared, number of triples: 5494
DEBUG: Entity list length: 1695, Relation list length: 363
DEBUG: Starting Monte Carlo sampling
DEBUG: Completed MC sample 1/5
DEBUG: Completed MC sample 2/5
DEBUG: Completed MC sample 3/5
DEBUG: Completed MC sample 4/5
DEBUG: Completed MC sample 5/5
DEBUG: Monte Carlo sampling completed
DEBUG: Stacked predictions shape: torch.Size([5, 5494])
DEBUG: Mean and std calculated
DEBUG: Converted to probabilities
DEBUG: Top 10 triples selected
DEBUG: Formatted 10 triples for return

==================== COMPARISON SAMPLE #3 ====================
Question: what was dr seuss 's real name
Answer entity: ['Theodor Seuss Geisel']
DEBUG: Starting inference on sample
DEBUG: Sample collated
DEBUG: Sample prepared, number of triples: 5494
DEBUG: Entity list length: 1695, Relation list length: 363
DEBUG: Starting Monte Carlo sampling
DEBUG: Completed MC sample 1/5
DEBUG: Completed MC sample 2/5
DEBUG: Completed MC sample 3/5
DEBUG: Completed MC sample 4/5
DEBUG: Completed MC sample 5/5
DEBUG: Monte Carlo sampling completed
DEBUG: Stacked predictions shape: torch.Size([5, 5494])
DEBUG: Mean and std calculated
DEBUG: Converted to probabilities
DEBUG: Top 10 triples selected
DEBUG: Formatted 10 triples for return

==================== COMPARISON SAMPLE #4 ====================
Question: what was dr seuss real name
Answer entity: ['Theodor Seuss Geisel']
DEBUG: Starting inference on sample
DEBUG: Sample collated
DEBUG: Sample prepared, number of triples: 5494
DEBUG: Entity list length: 1695, Relation list length: 363
DEBUG: Starting Monte Carlo sampling
DEBUG: Completed MC sample 1/5
DEBUG: Completed MC sample 2/5
DEBUG: Completed MC sample 3/5
DEBUG: Completed MC sample 4/5
DEBUG: Completed MC sample 5/5
DEBUG: Monte Carlo sampling completed
DEBUG: Stacked predictions shape: torch.Size([5, 5494])
DEBUG: Mean and std calculated
DEBUG: Converted to probabilities
DEBUG: Top 10 triples selected
DEBUG: Formatted 10 triples for return

==================== UNCERTAINTY COMPARISON ====================
Custom query average uncertainty: 1.0624
Test set average uncertainty: 0.6282 (std: 0.1535)
Relative difference: 69.12%
experiment completed
